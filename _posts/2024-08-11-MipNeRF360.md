---
layout: distill
title: Mip-NeRF 360
date: 2024-08-11 01:03:00
description: Unbounded Anti-Aliased Neural Radiance Fields
tags: nerf rendering 3d multiscale antialiasing
categories: 3d-view-synthesis
thumbnail: assets/img/2024-08-11-MipNeRF360/1.png
bibliography: 2024-08-11-MipNeRF360.bib
giscus_comments: false
disqus_comments: true
related_posts: true
# toc:
#   beginning: true
#   sidebar: right
featured: true
toc:
  - name: Introduction
  - name: Scene and Ray Parameterization
  - name: Coarse-to-Fine Online Distillation
  - name: Regularization for Interval-Based Models
  - name: Optimization
  - name: Results
  - name: Conclusion
  - name: Question
  - name: Code Review
  - name: Appendix
_styles: >
  .fake-img {
    background: #bbb;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 0px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 12px;
  }
  .fake-img p {
    font-family: monospace;
    color: white;
    text-align: left;
    margin: 12px 0;
    text-align: center;
    font-size: 16px;
  }
---

## Mip-NeRF 360: Unbounded Anti-Aliased Neural Radiance Fields

#### Jonathan T. Barron, Ben Mildenhall, Dor Verbin, Pratul P. Srinivasan, Peter Hedman 

> paper :  
[https://arxiv.org/abs/2111.12077](https://arxiv.org/abs/2111.12077)  
project website :  
[https://jonbarron.info/mipnerf360/](https://jonbarron.info/mipnerf360/)  
pytorch code :  
[https://github.com/google-research/multinerf](https://github.com/google-research/multinerf)

> 핵심 요약 :  
1. ddd

## Introduction

- Motivation :  
direction(360 degrees)과 depth가 임의로 unbounded 되어있는 scene에 대해 개선
  - non-linear scene parameterization
  - online-distillation
  - distortion-based regularizer

- NeRF model을 large unbounded scene에 적용하는 데 3가지 문제가 있다  
(자세한 내용은 스킵했는데 나중에 읽어보자)  
  - Parametrization : Mip-NeRF는 3D coordinate가 bounded domain 안에 있는 경우만 처리 가능
  - Efficiency : large-and-detailed scene은 large MLP를 필요로 해서 expensive
  - Ambiguity : scene content가 임의의 distance에 있고 이는 only 적은 수의 ray로 관찰되기 때문에 inherent ambiguity 발생

## Scene and Ray Parameterization

- Define smooth coordinate-transformation function as $$f(x) : R^3 \rightarrow R^3$$  
  - $$f(x) \approx f(\mu) + J_{f}(\mu)(x-\mu)$$  
  $$f(\mu, \Sigma) = (f(\mu), J_{f}(\mu) \Sigma J_{f}(\mu)^T)$$  
  - 이는 state transition model $$f = \text{contract}(x) = \begin{cases} x & \text{if} \| x \| \leq 1 \\ (2 - \frac{1}{\| x \|})(\frac{x}{\| x \|}) & \text{if} \| x \| \gt 1 \end{cases}$$ 에 대해  
  classic Extended Kalman filter <d-cite key="kalman">[1]</d-cite> 와 수학적으로 동일  
  - 멀리 있는 points는 distance가 아니라 그의 역수인 disparity에 비례하여 분포해야 한다는 점을 이용  
  - MipNeRF360에서는 contract 함수를 point가 아니라 Euclidean 3D-space에 있는 Gaussian에 적용!

- Scene Parametrization :  
  - Mip-NeRF :  
  $$\gamma (\mu, \Sigma) = \left[ \begin{bmatrix} sin(2^l \mu) \circledast exp(-\frac{1}{2} 4^l diag(\Sigma)) \\ cos(2^l \mu) \circledast exp(-\frac{1}{2} 4^l diag(\Sigma)) \end{bmatrix} \right]_{l=0}^{l=L-1}$$  
  - Mip-NeRF 360 :  
  $$\gamma (\text{contract}(\mu, \Sigma))$$  
  where $$\text{contract}(x) = \begin{cases} x & \text{if} \| x \| \leq 1 \\ (2 - \frac{1}{\| x \|})(\frac{x}{\| x \|}) & \text{if} \| x \| \gt 1 \end{cases}$$  

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/2024-08-11-MipNeRF360/1.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    contract 함수는 파란색 구(radius 1) 외부의 Gaussian(회색)을 주황색 영역(radius 1 ~ 2)의 Gaussian(빨간색)으로 mapping
</div>

- Ray Interval Parameterization :  
  - NeRF :  
    - NeRF에서는 distance에 비례하여 stratified uniform sampling을 했는데,  
    만약 NDC parameterization을 쓰면  
    disparity (distance의 역수)에 비례하여 uniform sampling 한 것과 같다  
    - 그런데 이러한 ray parameterization은 single direction으로만 unbounded scene (front-facing camera)에 대해서만 적합하고  
    모든 방향으로 unbounded scene에 대해서는 적합하지 않음  
  - MipNeRF360 :  
    - 처음부터 ray interval을 disparity (distance의 역수)에 비례하도록 <d-cite key="LLFF">[2]</d-cite> 정한다  
    - contract 함수도 마찬가지로 disparity에 비례하여 mapping하므로  
    scene origin에서 cast된 ray의 경우  
    contract 함수를 적용한 후에는 위의 주황색 영역에서 일정한 길이의 interval을 가진다


## Coarse-to-Fine Online Distillation

## Regularization for Interval-Based Models

## Optimization

## Results

## Conclusion

## Question

- Q&A reference : 3DGS online study
- Q1 :
- A1 :

## Code Review

## Appendix